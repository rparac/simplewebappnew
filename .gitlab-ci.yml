stages:
  - compile
  - test
  - deploy

default:
  image: ubuntu:18.04
  before_script:
    - apt-get update
    - apt-get -y install texlive
    - apt -y install pandoc
    - apt-get -y install maven
    - apt-get -y install openjdk-11-jre openjdk-11-jdk
    - apt-get -y install ruby-dev
    - gem install dpl
 
compile:
  stage: compile
  script: mvn compile

test:
  stage: test
  script: mvn test

deploy:
  stage: deploy
  script: 
    - export PORT=5000
    - mvn package
    - sh target/bin/simplewebapp &> /dev/null &
    - dpl --provider=heroku --app=rp218-simplewebapp --api-key=43b796c8-8edb-4469-8d21-9c727720367a
